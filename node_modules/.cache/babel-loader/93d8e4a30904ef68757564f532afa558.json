{"ast":null,"code":"import _regeneratorRuntime from\"/Users/helby1/Desktop/FULL STACK ACADEMY/Course_Work/project_09/Strangers Things/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/helby1/Desktop/FULL STACK ACADEMY/Course_Work/project_09/Strangers Things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/helby1/Desktop/FULL STACK ACADEMY/Course_Work/project_09/Strangers Things/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useParams}from\"react-router-dom\";import{postMessage,fetchAllPosts}from\"../api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddMessage=function AddMessage(_ref){var username=_ref.username,token=_ref.token,isLoggedIn=_ref.isLoggedIn;var _useParams=useParams(),postId=_useParams.postId;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),messageContent=_useState2[0],setMessageContent=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),messageSuccess=_useState4[0],setMessageSuccess=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newMessageDisplay=_useState6[0],setNewMessageDisplay=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),allPosts=_useState8[0],setAllPosts=_useState8[1];var postIdArray=postId.split('');postIdArray.shift();var colonlessPostId=postIdArray.join('');useEffect(function(){var getPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var returnedPosts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetchAllPosts(token);case 2:returnedPosts=_context.sent;setAllPosts(returnedPosts);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getPosts(){return _ref2.apply(this,arguments);};}();getPosts();},[]);var submitMessage=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(evt){var result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:evt.preventDefault();console.log(\"token: \",token);console.log(\"postId: \",colonlessPostId);console.log(\"messagecontent: \",messageContent);_context2.next=6;return postMessage(colonlessPostId,token,messageContent);case 6:result=_context2.sent;if(result.success){setMessageSuccess(true);}setNewMessageDisplay(result.data.message.content);return _context2.abrupt(\"return\",result);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function submitMessage(_x){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"section\",{id:\"add-message-container\",children:[allPosts.map(function(eachPost,index){{if(eachPost._id===colonlessPostId){return/*#__PURE__*/_jsxs(\"section\",{className:\"each-post-section\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"post-label\",children:\"Item: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"post-title\",children:eachPost.title}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"post-label\",children:\"Location: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"post-location\",children:eachPost.location}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"post-label\",children:\"Description: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"post-description\",children:eachPost.description}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"post-label\",children:\"Price: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"post-price\",children:eachPost.price}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"post-label\",children:\"Delivery Available: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"post-delivery\",children:eachPost.willDeliver?\"Yes\":\"No\"}),/*#__PURE__*/_jsx(\"br\",{})]},index);}}}),/*#__PURE__*/_jsxs(\"form\",{id:\"message-form\",onSubmit:submitMessage,children:[/*#__PURE__*/_jsx(\"input\",{id:\"message-box\",type:\"text\",value:messageContent,placeholder:\"message content\",onChange:function onChange(evt){return setMessageContent(evt.target.value);}}),/*#__PURE__*/_jsx(\"input\",{id:\"submit-message\",type:\"submit\",disabled:isLoggedIn?false:true,value:isLoggedIn?\"Submit\":\"Please Log In\"})]}),messageSuccess?/*#__PURE__*/_jsxs(\"section\",{className:\"each-post-section\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"message-label\",children:\"Message: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"message-content\",children:newMessageDisplay}),/*#__PURE__*/_jsx(\"br\",{})]}):null]});};export default AddMessage;","map":{"version":3,"names":["React","useState","useEffect","useParams","postMessage","fetchAllPosts","AddMessage","username","token","isLoggedIn","postId","messageContent","setMessageContent","messageSuccess","setMessageSuccess","newMessageDisplay","setNewMessageDisplay","allPosts","setAllPosts","postIdArray","split","shift","colonlessPostId","join","getPosts","returnedPosts","submitMessage","evt","preventDefault","console","log","result","success","data","message","content","map","eachPost","index","_id","title","location","description","price","willDeliver","target","value"],"sources":["/Users/helby1/Desktop/FULL STACK ACADEMY/Course_Work/project_09/Strangers Things/src/components/AddMessage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { postMessage, fetchAllPosts } from \"../api\";\n\n\n\n\nconst AddMessage = ({ username, token, isLoggedIn}) => {\n    const { postId } = useParams();\n    const [messageContent, setMessageContent] = useState('');\n    const [messageSuccess, setMessageSuccess] = useState(false);\n    const [newMessageDisplay, setNewMessageDisplay] = useState('')\n    const [allPosts, setAllPosts] = useState([]);\n\n    let postIdArray = postId.split('');\n    postIdArray.shift();\n    let colonlessPostId = postIdArray.join('')\n\n    useEffect(() =>  {\n        \n        const getPosts = async () => {\n            let returnedPosts = await fetchAllPosts(token);\n            setAllPosts(returnedPosts);\n        }\n\n\n    getPosts();\n    }, [])\n\n   \n\n    const submitMessage = async (evt) => {\n        evt.preventDefault();\n            console.log(\"token: \", token)\n            console.log(\"postId: \", colonlessPostId)\n            console.log(\"messagecontent: \", messageContent)\n        const result = await postMessage(colonlessPostId, token, messageContent)\n        if (result.success) {\n            setMessageSuccess(true)}\n            setNewMessageDisplay(result.data.message.content)\n        return result;\n    }\n\n\n    return (\n        <section id=\"add-message-container\">\n            {\n                allPosts.map((eachPost, index) => {\n                    { \n                        if (eachPost._id === colonlessPostId) {\n                            return (\n                            <section className =\"each-post-section\" key={index}>\n                                <span className=\"post-label\">Item: </span>\n                                <span className=\"post-title\">{eachPost.title}</span><br></br>\n                                <span className=\"post-label\">Location: </span>\n                                <span className=\"post-location\">{eachPost.location}</span><br></br>\n                                <span className=\"post-label\">Description: </span>\n                                <span className=\"post-description\">{eachPost.description}</span><br></br>\n                                <span className=\"post-label\">Price: </span>\n                                <span className=\"post-price\">{eachPost.price}</span><br></br>\n                                <span className=\"post-label\">Delivery Available: </span>\n                                <span className=\"post-delivery\">{eachPost.willDeliver ? \"Yes\" : \"No\"}</span><br></br>\n                            </section>)\n                        }\n                    }\n                })\n                    \n            }\n\n            <form id= 'message-form'\n                onSubmit={submitMessage}>\n                <input\n                    id='message-box'\n                    type='text'\n                    value={messageContent}\n                    placeholder=\"message content\"\n                    onChange={(evt) => setMessageContent(evt.target.value)}\n                    >\n                </input>\n                <input\n                    id=\"submit-message\"\n                    type=\"submit\"\n                    disabled= {isLoggedIn ? false : true}\n                    value={isLoggedIn ? \"Submit\" : \"Please Log In\"} >\n                </input>\n            </form>\n            {\n                messageSuccess ?\n                <section className=\"each-post-section\">\n                    <span className=\"message-label\">Message: </span>\n                    <span className=\"message-content\">{newMessageDisplay}</span><br></br>                 \n                </section>\n                :\n                null\n            }\n           \n        </section>\n    )\n\n}\n\nexport default AddMessage;"],"mappings":"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"},"metadata":{},"sourceType":"module"}